<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">20 posts tagged with &quot;FirefoxOS&quot; | 蓋索林 Gasolin</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://blog.gasolin.idv.tw/tags/firefox-os/page/2"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="20 posts tagged with &quot;FirefoxOS&quot; | 蓋索林 Gasolin"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://blog.gasolin.idv.tw/tags/firefox-os/page/2"><link data-rh="true" rel="alternate" href="https://blog.gasolin.idv.tw/tags/firefox-os/page/2" hreflang="en"><link data-rh="true" rel="alternate" href="https://blog.gasolin.idv.tw/tags/firefox-os/page/2" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="蓋索林 Gasolin RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="蓋索林 Gasolin Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-2833924-9"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-2833924-9",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.94df118e.css">
<script src="/assets/js/runtime~main.1cb2238c.js" defer="defer"></script>
<script src="/assets/js/main.577036e3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/avatar.jpg" alt="gasolin blog" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/avatar.jpg" alt="gasolin blog" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">蓋索林 Gasolin</b></a><a href="https://gasolin.idv.tw/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Home<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/tags">Tags</a><a class="navbar__item navbar__link" href="/life/mylifetools">我的工具箱</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2026</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/life/self-agent">用自己的代理（SelfAgent），讀自己的資料</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/life/2026-how-i-treat-ai">器靈與技能魔石 - 我如何看待 AI (2026)</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/life/my-investment-2025">這一年的投資 (2025)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/service/p2p-and-dht">不用伺服器也能通訊？P2P 聊天 App 的啟動魔法</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tools/ollama">使用 Ollama 與 Holesail 遠端運行本地模型</a></li></ul></div></nav></aside><main class="col col--7"><header class="margin-bottom--xl"><h1>20 posts tagged with &quot;FirefoxOS&quot;</h1><a href="/tags">View All Tags</a></header><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/devtools/Future-proved-Javascript-and-CSS">Future proved Javascript and CSS</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2015-02-28T17:42:32.000Z">February 28, 2015</time> · <!-- -->3 min read</div></header><div class="markdown"><iframe allowfullscreen="" frameborder="0" height="440" mozallowfullscreen="" msallowfullscreen="" oallowfullscreen="" src="https://www.flickr.com/photos/ikimuled/16354509187/in/pool-backtothefuture/player/" webkitallowfullscreen="" width="500"></iframe>
<p><a href="https://babeljs.io/" target="_blank" rel="noopener noreferrer" class="">This time, its different</a>. The transpilers are build-time polyfills that fill the gap of current browser/server implementation and the newest JS/CSS specs.</p>
<p>Transpilers trans-compile Javascript and CSS to current workable version, so developers could be more productive with JS/CSS latest features and transpilers would translate them into current supported version of code.</p>
<p>From my opinion the most useful es6 feature is <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions" target="_blank" rel="noopener noreferrer" class="">arrow functions</a> (=&gt;) which comes from coffeescript. This syntax sugar bind the this value automatically, so developer wont forgot the binding anymore.</p>
<p>The original code is</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ‘use strict’</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">‘DocumentLocalized’</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">// App.init();</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">bind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>We can use arrow function to replace <code>function() {}.bind(this)</code> to <code>() =&amp;gt; {}</code></p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ‘use strict’</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">‘DocumentLocalized’</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">// App.init();</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>Currently the arrow functions <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions#Browser_compatibility" target="_blank" rel="noopener noreferrer" class="">only default enabled on Firefox</a>. So developer could not use this directly on their project. With <a href="https://babeljs.io/" target="_blank" rel="noopener noreferrer" class="">babel</a> javascript transpiler the js could be translated to current workable version automatically.</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ‘use strict’</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">‘DocumentLocalized’</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">// App.init();</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>The transpiler will know the content does not need &#x27;this&#x27; reference and skip the binding. Note the Javascript transpiler still stick into <a href="http://vanilla-js.com/" target="_blank" rel="noopener noreferrer" class="">vanilla javascript</a>. It does not invent new syntax, but it make new specs could be used or experiment in current environment.</p>
<p>From CSS perspective, <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_variables" target="_blank" rel="noopener noreferrer" class="">CSS variables</a> brings variables into CSS. Pre-define some color and use everywhere on project is possible.</p>
<p>The origin style is</p>
<div class="language-css codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-css codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token selector" style="color:#00009f">a</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">color</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token hexcode color">#847AD1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token selector" style="color:#00009f">pre</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">padding</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token unit">px</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>It&#x27;s frustrated when the stylesheets expand larger and we need to change the new color or size everywhere.</p>
<p>We can use CSS variables to predefine the changeable stuff into pseudo &#x27;:root&#x27; element.</p>
<div class="language-css codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-css codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token selector pseudo-class" style="color:#00009f">:root</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">–maincolor</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token hexcode color">#847AD1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">–size</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token unit">px</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token selector" style="color:#00009f">a</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">color</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">var</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">–maincolor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token selector" style="color:#00009f">pre</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">padding</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">var</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">–size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>Looks good. But the same situation occurred. Currently the CSS variables <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_variables#Browser_compatibility" target="_blank" rel="noopener noreferrer" class="">only support on Firefox</a>. So developer could not use this directly on their project. With <a href="http://www.myth.io/" target="_blank" rel="noopener noreferrer" class="">myth</a> CSS transpiler the CSS could be translated to current workable version automatically.</p>
<div class="language-css codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-css codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token selector" style="color:#00009f">a</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">color</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token hexcode color">#847AD1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token selector" style="color:#00009f">pre</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">padding</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token unit">px</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>Note the CSS transpiler still stick into CSS specs. It does not invent new syntaxes like LESS or SASS does. It just make new CSS specs could be used or experiment in current environment.</p>
<p>Besides the feature polyfill, running transpiler before deploy also help developer catch out the error since transpiler will traverse the source and parsing syntaxes. Transpiler will bark you when any error in your source.</p>
<p>You may wonder setup an environment with above JS/CSS transpiler seems take some time. <a href="https://github.com/webapplate/webapplate" target="_blank" rel="noopener noreferrer" class="">webapplate</a> 2.3.0 already integrated with <a href="https://babeljs.io/" target="_blank" rel="noopener noreferrer" class="">babel</a>  and <a href="http://www.myth.io/" target="_blank" rel="noopener noreferrer" class="">myth</a> grunt tasks to auto transpile your JS/CSS code to current workable version. <a href="https://github.com/webapplate/webapplate" target="_blank" rel="noopener noreferrer" class="">webapplate</a> jshint/githook also support <a href="https://github.com/webapplate/webapplate/blob/master/.jshintrc#L17" target="_blank" rel="noopener noreferrer" class="">es6 syntax</a> validation (yes the .jshintrc is exactly borrowed from gaia project), so your project is future proved and keep maintainable.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/webapp">webapp</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/firefox-os">FirefoxOS</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/webframework">webframework</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/mozilla/Single-line-of-style-to-bring-keypart-of-f-lux-on-FirefoxOS">Single line of style to bring (keypart of) f.lux on FirefoxOS</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2015-02-24T07:34:23.000Z">February 24, 2015</time> · <!-- -->3 min read</div></header><div class="markdown"><p>Claim: this exercise is for experiment, not for product.</p>
<p></p>
<p>According to <a href="http://en.wikipedia.org/wiki/F.lux" target="_blank" rel="noopener noreferrer" class="">wikipedia</a>, <strong>f.lux</strong> adjusts a computer display&#x27;s <a href="http://en.wikipedia.org/wiki/Color_temperature" target="_blank" rel="noopener noreferrer" title="Color temperature" class="">color temperature</a> according to its location and time of day. I always use it on my Mac to make my eyes more comfortable at night.</p>
<p>So, the topic is about if we can bring that experience on Firefox OS.
Adjust display&#x27;s color temperature generally is a system specific issue. But actually it can be categorized as an CSS trick if we like to <a href="https://gist.github.com/contra/254e1a5a07da830d6051" target="_blank" rel="noopener noreferrer" class="">make it on web</a> (a gist to mimic the f.lux effect).</p>
<p>To quick experiment if it doable or not, the validation steps are:</p>
<p>1. open the <a href="https://developer.mozilla.org/en-US/docs/Tools/WebIDE" target="_blank" rel="noopener noreferrer" class="">WebIDE</a> on <a href="https://www.mozilla.org/en-US/firefox/developer/" target="_blank" rel="noopener noreferrer" class="">Firefox Developer Edition</a>
2. download and open emulator (I choose v2.2) on WebIDE.
3. To debug system app, choose <code>System</code> from top left selector in WebIDE.
4. once connected,  select the <code>html</code> tag and add style
<code>**filter: brightness(0.8) sepia(0.9);**</code> into the element.</p>
<p></p>
<p>The live view changed to f.lux like color temperature.</p>
<p></p>
<p>So it works!</p>
<p>To make it persistent on real device, edit <code>[gaia/apps/system/style/system/system.css](https://github.com/mozilla-b2g/gaia/blob/master/apps/system/style/system/system.css#L5)</code>, add above style into <code>html</code> tag. Run <code>make reset-gaia</code> then you have the style applied on device.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="whats-next">What&#x27;s Next<a href="#whats-next" class="hash-link" aria-label="Direct link to What&#x27;s Next" title="Direct link to What&#x27;s Next" translate="no">​</a></h3>
<p>The above experiment will change your device&#x27;s color temperature permanently, which is not what f.lux do. To make it as option, you can add an option in settings &gt; developer panel and add a observer in system to dynamically add such style into system html tag.</p>
<p>If you feel the strong desire to have such feature happen on Firefox OS device, fire a bug on <a href="http://bugzilla.mozilla.org/" target="_blank" rel="noopener noreferrer" class="">bugzilla</a>.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/firefox-os">FirefoxOS</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/devtools/Code-Flower-of-Gaia-The-firefox-OS-front-end">Code Flower of Gaia - The firefox OS front end</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2015-01-07T05:16:51.000Z">January 7, 2015</time> · <!-- -->3 min read</div></header><div class="markdown"><p></p>
<p>There are <a href="https://www.codefellows.org/blog/visualizing-the-history-of-node-js-via-git-commits" target="_blank" rel="noopener noreferrer" class="">several source code visualization</a> tools available for choose. I&#x27;ve tried  <a href="https://code.google.com/p/codeswarm/" target="_blank" rel="noopener noreferrer" class="">Code Swarm</a> long time ago and this time I&#x27;d like to try something that can be done on web directly. So, here&#x27;s the <a href="http://gasolin.github.io/CodeFlower/" target="_blank" rel="noopener noreferrer" class="">Gaia source code visulization</a> rendered by <a href="http://redotheweb.com/CodeFlower/" target="_blank" rel="noopener noreferrer" class="">CodeFlower</a> via <a href="http://d3js.org/" target="_blank" rel="noopener noreferrer" class="">D3.js</a>.</p>
<p>The prosperity of blossom denotes different</p>
<p></p>
<p>Orange is the settings app flower. The upperside are modulized setting panels. We can see good order of them. The downside crowds are things that not that modularized.</p>
<p></p>
<p>The purple sparkled flower is gaia web components. The main part is gaia-header, the top left part is gaia-grid.</p>
<p></p>
<p>The system app is a flower with a more concrete shape.</p>
<p></p>
<p>The calendar app (in yellow) looks like a pretty Dandelion.</p>
<p></p>
<p> What about others? go <a href="http://gasolin.github.io/CodeFlower/" target="_blank" rel="noopener noreferrer" class="">Gaia source code visulization</a> and check by yourself. (The repo is a digest from 2015/1/7 master)</p>
<p>And you can make your own by forking <a href="https://github.com/fzaninotto/CodeFlower" target="_blank" rel="noopener noreferrer" class="">CodeFlower</a> from github.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/firefox-os">FirefoxOS</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/code/apply-FLUX-arch-for-Javascript-code">使用 FLUX 架構的概念，漸進改善一般 Javascript 程式碼的組織方式</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2014-12-03T23:43:59.000Z">December 3, 2014</time> · <!-- -->11 min read</div></header><div class="markdown"><p>前陣子 Facebook 推出一套名為 <a href="http://fluxxor.com/what-is-flux.html" target="_blank" rel="noopener noreferrer" class="">FLUX</a> 的前端程式架構，期望能幫過去沒有條理，程式多了結構就亂得像一團麵條的 Javascript 程式寫法找到一個理想的組織方法。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="flux-簡介">FLUX 簡介<a href="#flux-簡介" class="hash-link" aria-label="Direct link to FLUX 簡介" title="Direct link to FLUX 簡介" translate="no">​</a></h3>
<blockquote>
<p>視圖（View）-&gt; 操作（Action）-&gt; 分配器（Dispatcher）-&gt; 資料處理器（Store）-&gt; 繪圖者（Renderer）-&gt; 視圖（View）
FLUX 的基本原理有別於常用的 MVC（Model/View/Controller）或 MVVM（Model/View/ViewModel）是在 M，Ｖ，C（VM）三者之間互相傳遞或修改資料，</p>
</blockquote>
<p></p>
<p>MVC (image from <a href="http://fluxxor.com/what-is-flux.html" target="_blank" rel="noopener noreferrer" class="">fluxxer</a>)</p>
<p>FLUX 重新定義整個組織架構為<strong>單向</strong>的視圖（View）-&gt; 操作（Action）-&gt; 分配器（Dispatcher）-&gt; 資料處理器（Store）-&gt; 繪圖者（Renderer）-&gt;  視圖（View）的運作流程。</p>
<p></p>
<p>FLUX (image from <a href="http://fluxxor.com/what-is-flux.html" target="_blank" rel="noopener noreferrer" class="">fluxxer</a>)</p>
<p>就我的理解，FLUX 的架構可以拆分為三個重點流程：</p>
<ul>
<li class="">跟視圖（View）有關的操作（Action），都透過事件註冊到分配器（Dispatcher）去。</li>
<li class="">分配器 （Dispatcher）負責將操作（Action）傳遞給需要的資料處理器（Store）。</li>
<li class="">資料處理器（Store）負責跟資料直接相關的操作。若資料處理器（Store）修改的結果需要反映到視圖（View）上，可以  透過發送訊息通知給繪圖者（Renderer）處理。這邊講到了原本 FLUX 概念圖中沒有提到的繪圖者（Renderer）這個角色，在 Facebook 中他們是用 <a href="http://facebook.github.io/react/" target="_blank" rel="noopener noreferrer" class="">ReactJS</a> 處理。</li>
</ul>
<p>瞭解其基本架構之後，我發現其實就算不用他們提供的函式庫，用 Javascript 內建的 addEventListener, handleEvent, customEvent 等方法，也可以利用前面所提的三個重點，漸進寫出符合 FLUX 精神的程式。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="目前的-js-組織方式">目前的 JS 組織方式<a href="#目前的-js-組織方式" class="hash-link" aria-label="Direct link to 目前的 JS 組織方式" title="Direct link to 目前的 JS 組織方式" translate="no">​</a></h3>
<p>一個常見的 JS 檔案，一般的架構是</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> </span><span class="token maybe-class-name">App</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> \</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">init</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">app_init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> \</span><span class="token punctuation" style="color:#393A34">{</span><br></span></code></pre></div></div>
<blockquote>
<p>      //get view
      this.view1 = document.getElementById (&#x27;xxx1&#x27;);
      this.view2 = document.getElementById (&#x27;xxx2&#x27;);
     
      //do stuff
      this.view1.addEventListener (&#x27;click&#x27;, function () {
        //do something
      });
      this.view2.addEventListener (&#x27;keyup&#x27;, function () {
        //do something
      });
    }
}; 若我們想要將視圖（View）的操作從 init 分離開來，大部分的人會這樣做</p>
</blockquote>
<blockquote>
<p> var App = {
    init: function app_init() {
      // get view
      this.view1 = document.getElementById(&#x27;xxx1&#x27;);
      this.view2 = document.getElementById(&#x27;xxx2&#x27;);
     
      // do stuff
      this.view1.addEventListener(&#x27;click&#x27;, <strong>this.clickView1</strong>);
      this.view2.addEventListener(&#x27;keyup&#x27;, <strong>this.keyupView2</strong>);
    },</p>
<p>    <strong>clickView1</strong>: function app_clickView1() {
       // do something
    },</p>
<p>    <strong>keyupView2</strong>: function app_keyupView2() {
       // do something
    }</p>
<p>};
如果在 clickView1 或 keyupView2 中要呼叫到 App 裡的參數或方法，那麼我們需要在 addEventListener 時使用 bind (this)</p>
</blockquote>
<blockquote>
<p> var App = {
    init: function app_init() {
      // get view
      this.view1 = document.getElementById(&#x27;xxx1&#x27;);
      this.view2 = document.getElementById(&#x27;xxx2&#x27;);
     
      // do stuff
      this.view1.addEventListener(&#x27;click&#x27;, this.clickView1**.bind(this)<strong>);
      this.view2.addEventListener(&#x27;keyup&#x27;, this.keyupView2</strong>.bind(this)**);
    },</p>
<p>    clickView1: function app_clickView1() {
       // do something
    },</p>
<p>    keyupView2: function app_keyupView2() {
       // do something
       this.clickView1();
    }</p>
<p>};
大多數書籍的範例大概就停在這裡，沒有再進一步探討程式的組織架構了。即使是龐大的 Javascript 專案如 <a href="https://github.com/mozilla-b2g/gaia" target="_blank" rel="noopener noreferrer" class="">Gaia</a>，不少部分的程式碼組織方式也是如此。在這種組織方式裡，若有很多的視圖（View）需要操作或修改，我們的程式碼就會開始亂起來。</p>
</blockquote>
<p>下面來試著將以上程式漸進改為 FLUX 架構。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="改進建議一將-handleevent-當作-dispatcher-來使用">改進建議一：將 handleEvent 當作 Dispatcher 來使用<a href="#改進建議一將-handleevent-當作-dispatcher-來使用" class="hash-link" aria-label="Direct link to 改進建議一：將 handleEvent 當作 Dispatcher 來使用" title="Direct link to 改進建議一：將 handleEvent 當作 Dispatcher 來使用" translate="no">​</a></h3>
<blockquote>
<p>跟視圖（View）有關的操作（Action），都透過事件註冊到分配器（Dispatcher）去。 （溫馨提示：IE 9 以上版本才有支援 handleEvent 方法，在之前版本上使用要加 polyfill）</p>
</blockquote>
<p>我們先來想想看視圖（View）跟操作（Action）在前端 Javascript 程式中分別代表著什麼。
視圖（View）很明顯，就是透過 getElementById 等方法，從 HTML 中取得代表對應節點（Node）的元素（element）。</p>
<p>若想要套用 FLUX 架構，我們可以將附加在各個元素（element）上的事件行為分離，將事件註冊到一個統一的地方（分配器），在這個地方對不同的事件進行操作。</p>
<p> Javascript 內建的分配器叫做 <a href="https://developer.mozilla.org/en-US/docs/Web/API/EventListener" target="_blank" rel="noopener noreferrer" class="">handleEvent</a>，它可以拿來處理任何事件 Event，寫法如下。</p>
<blockquote>
<p> var App = {
    init: function app_init() {
      // get view
      this.view1 = document.getElementById(&#x27;xxx1&#x27;);
      this.view2 = document.getElementById(&#x27;xxx2&#x27;);
     
      // do stuff
      this.view1.addEventListener(&#x27;click&#x27;, <strong>this</strong>);
      this.view2.addEventListener(&#x27;keyup&#x27;, <strong>this</strong>);
    },</p>
<p>    <strong>handleEvent</strong>: app_handleEvent(evt) {
       switch (evt.type) {
         case &#x27;click&#x27;:
           switch (evt.target) {
              case this.view1:
                this.clickView1();
                break;
           }
           break;
         case &#x27;keyup&#x27;:
            switch (evt.target) {
              case this.view2:
                this.keyupView2();
                break;             }
       }
    },</p>
<p>    clickView1: function app_clickView1() {
       // do something
    },</p>
<p>    keyupView2: function app_keyupView2() {
       // do something
       this.clickView1();
    }</p>
<p>}; 這麼做帶來的明顯好處是所有的呼叫都統一在 handleEvent 中，可以更容易地追查到。</p>
</blockquote>
<p>這麼寫也可以在 addEventListener/removeEventListener 時不用使用 bind (this)，而 bind (this) 經常有些 side effect 需要特別留意。</p>
<p>例如假使我們想要反註冊 view1 上的 click 方法，使用以下寫法</p>
<blockquote>
<p> this.view1.removeEventListener (&#x27;click&#x27;, this.clickView1.bind (this)); 其實並沒有將第一個 event 移除。因為使用了 **.bind (this) ** 後，回傳的其實是一個新的 instance...。
正確的寫法是
<strong>this.bindClickView1</strong> = this.clickView1.bind(this)</p>
</blockquote>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">view1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;click&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">bindClickView1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<blockquote>
<p>...</p>
</blockquote>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">view1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">removeEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;click&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">bindClickView1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">用 handleEvent 可以省點事，要反註冊時也傳入 </span><span class="token keyword" style="color:#00009f">this</span><span class="token plain"> 即可。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">view1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">removeEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;click&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="改進建議二將資料處理的部分分離使用自訂事件來改變-store-狀態">改進建議二：將資料處理的部分分離，使用自訂事件來改變 Store 狀態<a href="#改進建議二將資料處理的部分分離使用自訂事件來改變-store-狀態" class="hash-link" aria-label="Direct link to 改進建議二：將資料處理的部分分離，使用自訂事件來改變 Store 狀態" title="Direct link to 改進建議二：將資料處理的部分分離，使用自訂事件來改變 Store 狀態" translate="no">​</a></h3>
<blockquote>
<p>分配器 （Dispatcher）負責將操作（Action）傳遞給需要的資料處理器（Store）
資料處理器（Store）負責跟資料直接相關的操作。在稍大的 Web App 中，我們可以另外定一個 Object 來處理資料相關的事宜。一般我們的寫法會是</p>
</blockquote>
<blockquote>
<p>// Store.js</p>
</blockquote>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Store</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> \</span><span class="token punctuation" style="color:#393A34">{</span><br></span></code></pre></div></div>
<blockquote>
<p>  this._data: 0;
};</p>
</blockquote>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">Store</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> \</span><span class="token punctuation" style="color:#393A34">{</span><br></span></code></pre></div></div>
<blockquote>
<p>  getSomething: function s_getSomething() {
    return this._data;
  },</p>
<p>  doSomething: function s_doSomething() {
    this._data += 1;
  },</p>
<p>  setSomething: function s_setSomething(val) {
    this._data = val;
  }
};</p>
<p>// App.js</p>
</blockquote>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> </span><span class="token maybe-class-name">App</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> \</span><span class="token punctuation" style="color:#393A34">{</span><br></span></code></pre></div></div>
<blockquote>
<p>  this.store = new Store ();
  this.store.init ();
  this.store.getSomething ();
  this.store.doSomething ();
  this.store.setSomething (2);
}; 若想要套用 FLUX 架構，首先我們要避免從資料處理器（Store）外部直接改變資料處理器（Store）。我們可以透過在呼叫端使用 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window.dispatchEvent" target="_blank" rel="noopener noreferrer" class="">window.DispatchEvent</a> 發送自訂事件（<a href="https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent" target="_blank" rel="noopener noreferrer" class="">CustomEvent）</a>，並在資料處理器（Store）中接收自訂事件來做到。</p>
</blockquote>
<p>如此一來，資料處理器（Store）將只留下 get 方法來讓外部取得 Store 想提供的資料。</p>
<p>另外如果程式碼改善進入到下一個重點，在操作（Action）時應該不需要再呼叫 Store.getSomething 了，我們將資料處理器（Store）的 getSomething 方法留著給繪圖者（Renderer）使用 。</p>
<blockquote>
<p>// Store.js</p>
</blockquote>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Store</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> \</span><span class="token punctuation" style="color:#393A34">{</span><br></span></code></pre></div></div>
<blockquote>
<p>  this._data: 0;
};</p>
</blockquote>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">Store</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> \</span><span class="token punctuation" style="color:#393A34">{</span><br></span></code></pre></div></div>
<blockquote>
<p>  init: function s_init() {
     <strong>window.addEventListener(&#x27;store_do&#x27;, this);</strong>
<strong>     window.addEventListener(&#x27;store_set&#x27;, this);</strong>
  },</p>
<p>  handleEvent: s_handleEvent(evt) {
    switch(evt.type) {
      case &#x27;store_do&#x27;:
        this.doSomething();
        break;
      case &#x27;store_set&#x27;:
        this.setSomething(<strong>evt.detail.val</strong>);
        break;
    }
  },</p>
<p>  getSomething: function s_getSomething() {
    return this._data;
  },</p>
<p>  _doSomething: function s_doSomething() {
    this._data += 1;
  },</p>
<p>  _setSomething: function s_setSomething(val) {
    this._data = val;
  }
};</p>
<p>// App.js</p>
</blockquote>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> </span><span class="token maybe-class-name">App</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> \</span><span class="token punctuation" style="color:#393A34">{</span><br></span></code></pre></div></div>
<blockquote>
<p>  this.store = new Store();
  this.store.init();
  //this.store.getSomething();
  **window..dispatchEvent(new CustomEvent(&#x27;store_do&#x27;));
  <strong><strong>window..dispatchEvent(new CustomEvent(&#x27;store_set&#x27;,</strong>
<strong>    {&#x27;detail&#x27;:{&#x27;val&#x27;:2}}
  )); **
}; 這麼做帶來的明顯好處是</strong>測試</strong>時可以簡單地將 Store 與 App 分開來測試，這對大型 App 是很重要的。</p>
</blockquote>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="改進建議三讓-renderer-來處理視圖">改進建 議三：讓 Renderer 來處理視圖<a href="#改進建議三讓-renderer-來處理視圖" class="hash-link" aria-label="Direct link to 改進建議三：讓 Renderer 來處理視圖" title="Direct link to 改進建議三：讓 Renderer 來處理視圖" translate="no">​</a></h3>
<blockquote>
<p>若資料處理器（Store）修改的結果需要反映到視圖（View）上，可以透過發送訊息通知給繪圖者（Renderer）處理 &gt; //  Renderer.js</p>
</blockquote>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> </span><span class="token maybe-class-name">ClickRenderer</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> \</span><span class="token punctuation" style="color:#393A34">{</span><br></span></code></pre></div></div>
<blockquote>
<p>  init: function s_init(element, Store) {
     this.element = element;
     this.store = Store;
     <strong>window.addEventListener(&#x27;render_view1&#x27;, this);</strong>
  },</p>
<p>  handleEvent: s_handleEvent(evt) {
    switch(evt.type) {
      case &#x27;render_view1&#x27;:
        this.element.textConent = this.store.getSomething();
        break;
    }
  }};</p>
<p>// Store.js</p>
</blockquote>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Store</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> \</span><span class="token punctuation" style="color:#393A34">{</span><br></span></code></pre></div></div>
<blockquote>
<p>  this._data: 0;
};</p>
</blockquote>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">Store</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">prototype</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> \</span><span class="token punctuation" style="color:#393A34">{</span><br></span></code></pre></div></div>
<blockquote>
<p>  init: function s_init() {
     window.addEventListener(&#x27;store_do&#x27;, this);
     window.addEventListener(&#x27;store_set&#x27;, this);
  },</p>
<p>  handleEvent: s_handleEvent(evt) {
    switch(evt.type) {
      case &#x27;store_do&#x27;:
        this.doSomething();
        break;
      case &#x27;store_set&#x27;:
        this.setSomething(evt.detail.val);
        break;
    }
  },</p>
<p>  getSomething: function s_getSomething() {
    return this._data;
  },</p>
<p>  _doSomething: function s_doSomething() {
    this._data += 1;
    <strong>window..dispatchEvent(new CustomEvent(&#x27;render_view1&#x27;));</strong>
  },</p>
<p>  _setSomething: function s_setSomething(val) {
    this._data = val;
  }
};</p>
<p>// App.js</p>
</blockquote>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> </span><span class="token maybe-class-name">App</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> \</span><span class="token punctuation" style="color:#393A34">{</span><br></span></code></pre></div></div>
<blockquote>
<p>  init: function a_init() {
    // get view
    this.view1 = document.getElementById(&#x27;xxx1&#x27;);
    this.view2 = document.getElementById(&#x27;xxx2&#x27;);
    this.store = new Store();
    this.store.init();
    **ClickRenderer.init(this.view1, **<strong>this.store);</strong>
  },</p>
<p> 
  handleEvent: a_handleEvent (evt) {
    window..dispatchEvent (new CustomEvent (&#x27;store_do&#x27;));
    //Store.setSomething (2)
    window..dispatchEvent (new CustomEvent (&#x27;store_set&#x27;,
      {&#x27;detail&#x27;:{&#x27;val&#x27;:2}}
    ));
};
上段程式在 App 中註冊了 ClickRenderer，並傳入 Store 與 所需的 View 元件。所有的介面更新全交由 ClickRenderer 處理。</p>
</blockquote>
<p>（另一個方法是讓繪圖者（Renderer）監看資料處理器（Store）的狀態，然後去改變視圖（View））
 <a href="http://fluxxor.com/documentation/store-watch-mixin.html" target="_blank" rel="noopener noreferrer" class="">http://fluxxor.com/documentation/store-watch-mixin.html</a></p>
<h3></h3>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="總結">總結<a href="#總結" class="hash-link" aria-label="Direct link to 總結" title="Direct link to 總結" translate="no">​</a></h3>
<p>整理完後，一般 javascript 套用 flux 架構的運作流程如下：</p>
<p></p>
<p>簡而言之，上面的各種建議是鼓勵大家多使用 Javascript 內建的 addEventListener, handleEvent, customEvent 等方法。透過大量使用 event，我們可以改善 Javascript 程式邏輯，資料，與介面元件之間的關聯程度。</p>
<p>將 FLUX 架構拆分為三個重點流程來理解或實踐的好處，是我們能漸進地遵循其中一些方法來改善我們現有的程式架構。</p>
<p>以上是我關於如何使用 FLUX 架構在一般 Javascript 組織方式的第三個版本，可能有些錯謬之處，還迎大家討論或給予建議。</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/webapp">webapp</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/firefox-os">FirefoxOS</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/mozilla/FoxBox-and-SummerOfCode14">FoxBox and SummerOfCode14</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2014-03-19T06:05:26.000Z">March 19, 2014</time> · <!-- -->2 min read</div></header><div class="markdown"><p><a href="http://github.com/gasolin/foxbox" target="_blank" rel="noopener noreferrer" class="">FoxBox</a> is the project that intent to provide a battery included Firefox OS build environment.</p>
<p><a href="https://github-camo.global.ssl.fastly.net/5a75456bd1293c04434f8c8a2373748a25d5deaf/687474703a2f2f692e696d6775722e636f6d2f465945305045352e706e67" target="_blank" rel="noopener noreferrer" class=""><img decoding="async" loading="lazy" src="https://github-camo.global.ssl.fastly.net/5a75456bd1293c04434f8c8a2373748a25d5deaf/687474703a2f2f692e696d6775722e636f6d2f465945305045352e706e67" alt="" class="img_ev3q"></a>
The goal of foxbox is to try any approach that make new user can do as less as possible to start the FirefoxOS development</p>
<p>Our first take is use <a href="http://www.vagrantup.com/downloads" target="_blank" rel="noopener noreferrer" class="">vagrant</a> with <a href="https://www.virtualbox.org/wiki/Downloads" target="_blank" rel="noopener noreferrer" class="">virtualbox</a> to make major platform users can try FirefoxOS dev in VM.</p>
<p>It will be great to setup the current version of foxbox in your desktop environment</p>
<p></p>
<p>And record obstacles you encountered here <a href="https://github.com/gasolin/foxbox/issues?state=open" target="_blank" rel="noopener noreferrer" class="">https://github.com/gasolin/foxbox/issues?state=open</a>.
There are some issues (but not the limit) that might be worth to do in the future version of foxbox.</p>
<p>Note that you require a desktop with INTEL VT-x/AMD-V hardware virtualization support(Windows8 or Mac already enabled it), at least 4GB RAM and about 10~40GB disk space(for gaia or full B2G development).</p>
<p>FoxBox has been approved by the Google Summer of Code administrator <a href="http://wiki.mozilla.org/Community:SummerOfCode14" target="_blank" rel="noopener noreferrer" class="">http://wiki.mozilla.org/Community:SummerOfCode14</a> , so its perfect time to step up, try FoxBox, fix issues that every others will encounter, save everybody&#x27;s time and start make your own Firefox OS phone.</p>
<p>If you&#x27;d like to contribute FoxBox for <a href="http://www.google-melange.com/gsoc/homepage/google/gsoc2014" target="_blank" rel="noopener noreferrer" class="">SummerOfCode14</a>. We expect you could find out the interesting topic you want to contribute or any other way that can better achieve FoxBox&#x27;s goal.
 </p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/mobile">mobile</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/mozilla">Mozilla</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/firefox-os">FirefoxOS</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/tags/firefox-os"><div class="pagination-nav__label">Newer entries</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/tags/firefox-os/page/3"><div class="pagination-nav__label">Older entries</div></a></nav></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Personal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.gasolin.idv.tw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Homepage<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://blog.gasolin.idv.tw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="http://www.mytravelmap.tk/u/gg112695256249584453237" target="_blank" rel="noopener noreferrer" class="footer__link-item">Traveled<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Career</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/gasolin" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 gasolin. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>