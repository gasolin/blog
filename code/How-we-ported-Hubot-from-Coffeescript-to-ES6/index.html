<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">How we ported Hubot from Coffeescript to ES6 | 蓋索林 Gasolin</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://blog.gasolin.idv.tw/code/How-we-ported-Hubot-from-Coffeescript-to-ES6"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="How we ported Hubot from Coffeescript to ES6 | 蓋索林 Gasolin"><meta data-rh="true" name="description" content="Hubo"><meta data-rh="true" property="og:description" content="Hubo"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2016-03-14T09:04:42.000Z"><meta data-rh="true" property="article:tag" content="javascript"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://blog.gasolin.idv.tw/code/How-we-ported-Hubot-from-Coffeescript-to-ES6"><link data-rh="true" rel="alternate" href="https://blog.gasolin.idv.tw/code/How-we-ported-Hubot-from-Coffeescript-to-ES6" hreflang="en"><link data-rh="true" rel="alternate" href="https://blog.gasolin.idv.tw/code/How-we-ported-Hubot-from-Coffeescript-to-ES6" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="蓋索林 Gasolin RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="蓋索林 Gasolin Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-2833924-9"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-2833924-9",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.94df118e.css">
<script src="/assets/js/runtime~main.1cb2238c.js" defer="defer"></script>
<script src="/assets/js/main.577036e3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/avatar.jpg" alt="gasolin blog" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/avatar.jpg" alt="gasolin blog" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">蓋索林 Gasolin</b></a><a href="https://gasolin.idv.tw/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Home<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a class="navbar__item navbar__link" href="/tags">Tags</a><a class="navbar__item navbar__link" href="/life/mylifetools">我的工具箱</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2026</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/life/self-agent">用自己的代理（SelfAgent），讀自己的資料</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/life/2026-how-i-treat-ai">器靈與技能魔石 - 我如何看待 AI (2026)</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/life/my-investment-2025">這一年的投資 (2025)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/service/p2p-and-dht">不用伺服器也能通訊？P2P 聊天 App 的啟動魔法</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/tools/ollama">使用 Ollama 與 Holesail 遠端運行本地模型</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">How we ported Hubot from Coffeescript to ES6</h1><div class="container_mt6G margin-vert--md"><time datetime="2016-03-14T09:04:42.000Z">March 14, 2016</time> · <!-- -->5 min read</div></header><div id="__blog-post-container" class="markdown"><p><a href="https://www.flickr.com/photos/franzbrandtwein/210333714/in/photolist-jA1Tm-7zsdd5-c3S9RY-6nV3Rp-96h4Vx-of3ttt-38gqh7-gmHXQv-dVEbJF-7E2T3H-HtFB3-robohy-druZRm-nrF4vh-HtFAN-7Dk3uW-pkMp7E-qpn51r-67WHcz-dmkogt-AkVdM-951oFH-af6bdQ-igcWis-bw1gLG-6ZkGsP-r3KjtA-aojgSy-qXYEst-ckHzAN-97rv7G-qfi5f6-bu6G96-4mdWDR-62fyWi-qgcVh4-89o3px-8AKiYq-Xb2wh-5K91Q3-rwerig-i19QiK-7jGYc7-2Pc3VK-bNBoUp-9RDmqK-9iEDUt-kb1z7K-dwYP4H-pN2djS" target="_blank" rel="noopener noreferrer" title="Hubo" class=""><img decoding="async" loading="lazy" src="https://farm1.staticflickr.com/91/210333714_cccff3a76f.jpg" alt="Hubo" class="img_ev3q"></a><script async="" charset="utf-8" src="//embedr.flickr.com/assets/client-code.js"></script></p>
<p>We (Fred Lin &amp; Ray Lin) have ported Github&#x27;s popular chat robot framework &#x27;<a href="https://github.com/github/hubot" target="_blank" rel="noopener noreferrer" class="">Hubot&#x27;</a> from Coffeescript to plain Javascript with ES6 features. Currently I name it <a href="https://github.com/gasolin/webbybot" target="_blank" rel="noopener noreferrer" class=""><strong>webbybot</strong></a> to denote ES6 version of hubot, to better test the port result and avoid the naming confusion with the original hubot.</p>
<p>Now webbybot is fully functional and still support all coffeescript written plugins.
If you have an existing bot generated by  hubot-generator, you can install webbybot via <code>npm  install webbybot</code> command, follow <a href="https://github.com/gasolin/webbybot#how-to-replace-hubot-to-webbybot" target="_blank" rel="noopener noreferrer" class="">with simple instruction</a> and see your bot works smoothly with webbybot core.</p>
<p>(For experienced developer, the instruction guide you to replace script in  generated &#x27;/bin&#x27; folder from &#x27;hubot&#x27; to &#x27;webby&#x27;. And change the adapter  library import from &#x27;hubot&#x27; to &#x27;webbybot&#x27;.)</p>
<p>As time goes to 2016, there&#x27;re less reason to use <a href="http://coffeescript.org/" target="_blank" rel="noopener noreferrer" class="">Coffeescript</a> instead of standard ES6 Javascript. During the porting we do learned something that might helpful for your projects.</p>
<p><strong>1. Use npm script directly instead of gulp or grunt</strong></p>
<p>With npm we can define some scripts directly in the &#x27;script&#x27; attribution of &#x27;package.json&#x27; file. Webbybot use &#x27;npm run build&#x27; command to compile ES6 to plain javascript via <a href="http://babeljs.io/" target="_blank" rel="noopener noreferrer" class="">Babel</a>. Do style checking via &#x27;npm run lint&#x27; command.</p>
<p><strong>2. Use babel directly instead of webpack</strong></p>
<p>At the beginning we count on <a href="https://webpack.github.io/" target="_blank" rel="noopener noreferrer" class="">webpack</a>&#x27;s babel-loader to convert ES6 to plain javascript. Alas its a beginning of &#x27;Try and Error&#x27; journey. Webpack is originally designed for front-end packaging and works very well on that purpose. But for backend program like webbybot that feature is not important for us. Webpack also bring &#x27;require&#x27; keyword to the front-end, but its not suit for backend program that depends on dynamic import. As a framework, hubot heavily counts on NODE require to load plugins. Webpack treat all &#x27;require&#x27; as its keyword and try hard in vain to find external modules from packed files.</p>
<p>We tried several ways to detour these side effects, and finally replaced the full webpack stack with <a href="https://github.com/gasolin/webbybot/blob/master/package.json#L10" target="_blank" rel="noopener noreferrer" class="">one line npm build script</a>. Now its easier to debug and no hacks needed in source code.</p>
<p><strong>3. return or not return, its the question</strong></p>
<p>We use the  &quot;Try Coffeescript&quot; utility provide form <a href="http://coffeescript.org/" target="_blank" rel="noopener noreferrer" class="">Coffeescript</a> official site, which you can paste Coffeescript the page will convert the source to Javascript instantly.
The converted code is... not all pretty for human read, and all converted functions will contain a return statement even its unnecessary. It needs check by hand.</p>
<p><strong>4. test cases matter</strong></p>
<p>Hubot itself contains good coverage of unit tests. So we are able to test one ported script file with one ported test file when we start the porting. The unit test files contain great number of redundant return sentences when convert from coffeescript.</p>
<p><strong>5. class and super</strong></p>
<p>Hubot use Class syntax from Coffeescript。Thanksfully ES6 support the Class syntax, which is a bit different from Coffeescript. You can check how to use Class and super on <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes" target="_blank" rel="noopener noreferrer" class="">MDN.</a></p>
<p><strong>6. Default + rest + spread</strong></p>
<p>Hubot contain several syntax like &#x27;reply(strings...)&#x27;. The syntax &#x27;strings...&#x27; in Coffeescript is correspondent to &quot;...strings&quot; in ES6（The order of &#x27;...&#x27; is reversed）.
&#x27;...strings&#x27; denotes an array and I feel its a bit hard to figure out when to expand it or not.</p>
<p><strong>7. for..of instead of for..in</strong></p>
<p>To use for..in loop in ES6, we need add &#x27;hasOwnProperty&#x27; check to make sure inherited property are not looped. Or we can rewrite for..in loop in Coffeescript to forEach iteration. Though there are some cases that need &#x27;break&#x27; or &#x27;return&#x27; from a loop.</p>
<p>Now we use ES6 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of" target="_blank" rel="noopener noreferrer" class="">for..of loop</a> in Webbybot to replace forEach and for..in loop. You need wrap object with Object.keys syntax to iterate with object. ex: <code>for (let item  of Object.keys(TargetObj)) {...}</code>.</p>
<p><strong>8. Object.assign instead of Extend</strong></p>
<p>We can use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign" target="_blank" rel="noopener noreferrer" class="">Object.assign</a> to extend a object without handmade extend function or lodash!</p>
<p><strong>9. Do you know hubot also <a href="https://github.com/gasolin/webbybot/blob/master/src/robot.js#L404" target="_blank" rel="noopener noreferrer" class="">support write plugin with plain javascript</a>?</strong></p>
<p>Learning how chat bot works is the main reason we start porting hubot to ES6!
A simple plain javascript plugin could be as easy as: (src/simple.js)</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; module.exports = function(robot) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; &amp;nbsp; robot.respond(/(hello)/i, function(res) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; &amp;nbsp; &amp;nbsp; res.send(&#x27;hi&#x27;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; &amp;nbsp; });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; }You can put it in generated plugin folder and it will just work.</span><br></span></code></pre></div></div>
<p>I&#x27;ve created a <a href="https://github.com/github/hubot/issues/1138" target="_blank" rel="noopener noreferrer" class="">ticket on hubot issue list</a> to start a discussion if hubot would like to go with ES6 in its future version.</p>
<p>The webbybot source is at<a href="https://github.com/gasolin/webbybot" target="_blank" rel="noopener noreferrer" class=""> https://github.com/gasolin/webbybot</a></p>
<p>Do you have a project ported from coffeescript to ES6? Welcome to drop by your thoughts.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/tags/javascript">javascript</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/gasolin/blog/edit/main/website/blog/blog/code/How-we-ported-Hubot-from-Coffeescript-to-ES6.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/iot/Setup-a-skype-chatbot-on-Respberry-pi-with-4GB-SD-Card"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Setup a skype chatbot on Respberry pi with 4GB SD Card</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/devtools/port-hubot-from-Coffescript-to-ES6"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">將聊天機器人框架 hubot 從 Coffescript 移植到 ES6</div></a></nav><div style="margin-top:20px"></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Personal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.gasolin.idv.tw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Homepage<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://blog.gasolin.idv.tw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="http://www.mytravelmap.tk/u/gg112695256249584453237" target="_blank" rel="noopener noreferrer" class="footer__link-item">Traveled<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Career</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/gasolin" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 gasolin. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>