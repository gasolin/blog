"use strict";(globalThis.webpackChunkblog=globalThis.webpackChunkblog||[]).push([[37831],{28453(e,t,n){n.d(t,{R:()=>o,x:()=>a});var i=n(96540);const r={},s=i.createContext(r);function o(e){const t=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(s.Provider,{value:t},e.children)}},47944(e){e.exports=JSON.parse('{"permalink":"/tools/node-red-contrib-bitfinex","editUrl":"https://github.com/gasolin/blog/edit/main/website/blog/blog/tools/node-red-contrib-bitfinex.md","source":"@site/blog/tools/node-red-contrib-bitfinex.md","title":"Interact Bitfinex API with Node-RED","description":"Imgur","date":"2019-01-07T14:33:42.000Z","tags":[{"inline":true,"label":"bitfinex","permalink":"/tags/bitfinex"},{"inline":true,"label":"nodered","permalink":"/tags/nodered"}],"readingTime":3.75,"hasTruncateMarker":false,"authors":[],"frontMatter":{"title":"Interact Bitfinex API with Node-RED","tags":["bitfinex","nodered"],"date":"2019-01-07T14:33:42.000Z"},"unlisted":false,"prevItem":{"title":"Tuning for my daily Elementary OS Juno","permalink":"/tools/elementary_juno"},"nextItem":{"title":"\u7528Raspberry Pi\u7d44\u88dd\u4e00\u5957\u5c0f\u670b\u53cb\u4f7f\u7528\u7684\u96fb\u8166","permalink":"/tools/raspberrypi-kano-os"}}')},77586(e,t,n){n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>l});var i=n(47944),r=n(74848),s=n(28453);const o={title:"Interact Bitfinex API with Node-RED",tags:["bitfinex","nodered"],date:new Date("2019-01-07T14:33:42.000Z")},a=void 0,c={authorsImageUrls:[]},l=[{value:"Getting start with Node-RED and Bitfinex API",id:"getting-start-with-node-red-and-bitfinex-api",level:2},{value:"Interact with Node-RED",id:"interact-with-node-red",level:2},{value:"Visualize data with Node-RED dashboard",id:"visualize-data-with-node-red-dashboard",level:2},{value:"One more thing",id:"one-more-thing",level:2},{value:"Other way to interact with Bitfinex API",id:"other-way-to-interact-with-bitfinex-api",level:2},{value:"Inreact with the REST API",id:"inreact-with-the-rest-api",level:3},{value:"Interact with API library",id:"interact-with-api-library",level:3}];function d(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"Anticipate how API choices and abstractions impact the way other people would solve the problem\n"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"There are many ways to access Bitfinex API to get most of Bitfinex exchange functionalities. For example, you can access REST API, websocket API, or call the language specific API library to eaze the interaction efforts. But in my opinion interact via Node-RED Bitfinex function block is the most easiest one."}),"\n",(0,r.jsx)(t.h2,{id:"getting-start-with-node-red-and-bitfinex-api",children:"Getting start with Node-RED and Bitfinex API"}),"\n",(0,r.jsx)(t.p,{children:"To get start, you can"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:["install Node-RED ",(0,r.jsx)(t.code,{children:"npm install -g node-red"}),"."]}),"\n",(0,r.jsxs)(t.li,{children:["Start Node-RED via ",(0,r.jsx)(t.code,{children:"node-red"})," command, then go ",(0,r.jsx)(t.code,{children:"settings > Palette > Install"})," tab in node-red"]}),"\n",(0,r.jsxs)(t.li,{children:["search ",(0,r.jsx)(t.code,{children:"bitfinex"})," to install this module."]}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"interact-with-node-red",children:"Interact with Node-RED"}),"\n",(0,r.jsx)(t.p,{children:"Node-RED is a great way to interact with everything online, with a more intuitive interface."}),"\n",(0,r.jsxs)(t.p,{children:["To simplify the interaction with Bitfinex,\nI wrapped the ",(0,r.jsx)(t.a,{href:"https://www.npmjs.com/package/node-red-contrib-bitfinex",children:"Bitfinex function block for Node-RED"}),", which makes bitfinex API very easy to access in Node-RED. You can visually show exchange data in node-red's dashboard, mashup with other services, or trade from weird objects around your house."]}),"\n",(0,r.jsx)(t.p,{children:"For example, you can follow the screenshot to make below REST API work."}),"\n",(0,r.jsx)(t.p,{}),"\n",(0,r.jsx)(t.p,{children:"Access websocket API is very simple as well"}),"\n",(0,r.jsx)(t.p,{}),"\n",(0,r.jsx)(t.p,{children:"You can use configuration block to put your apiKey and apiSecret."}),"\n",(0,r.jsx)(t.p,{}),"\n",(0,r.jsx)(t.h2,{id:"visualize-data-with-node-red-dashboard",children:"Visualize data with Node-RED dashboard"}),"\n",(0,r.jsxs)(t.p,{children:["Once you got the data via bitfinex function block, it's pretty easy to visualize value and diagram with ",(0,r.jsx)(t.a,{href:"https://flows.nodered.org/node/node-red-dashboard",children:"Node-RED dashboard"})]}),"\n",(0,r.jsx)(t.p,{}),"\n",(0,r.jsx)(t.p,{}),"\n",(0,r.jsx)(t.h2,{id:"one-more-thing",children:"One more thing"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.code,{children:"You may not know"})," the ",(0,r.jsx)(t.a,{href:"https://docs.bitfinex.com/v2/reference#rest-public-tickers",children:"tickers api"})," allow query multiple symbols at once, like ",(0,r.jsx)(t.code,{children:"rest.tickers(['tETHUSD', 'tBTCUSD'])"})," and this functoin block supports multiple outputs as well!"]}),"\n",(0,r.jsx)(t.p,{}),"\n",(0,r.jsxs)(t.p,{children:["If you make something interesting with Bitfinex API and node-RED, please let me know! (You can share to ",(0,r.jsx)(t.a,{href:"https://github.com/gasolin/node-red-contrib-bitfinex/issues",children:"https://github.com/gasolin/node-red-contrib-bitfinex/issues"}),")"]}),"\n",(0,r.jsx)(t.h2,{id:"other-way-to-interact-with-bitfinex-api",children:"Other way to interact with Bitfinex API"}),"\n",(0,r.jsx)(t.p,{children:"For reference, You can learn more ways to access the Bitfinex API below."}),"\n",(0,r.jsx)(t.h3,{id:"inreact-with-the-rest-api",children:"Inreact with the REST API"}),"\n",(0,r.jsxs)(t.p,{children:["We could read the ",(0,r.jsx)(t.a,{href:"https://docs.bitfinex.com/v2/reference#rest-public-tickers%60",children:"API doc"})," and find we can get the recent ETH/USD pair states via open the browser and visit ",(0,r.jsx)(t.a,{href:"https://api.bitfinex.com/v2/tickers?symbols=tETHUSD",children:"https://api.bitfinex.com/v2/tickers?symbols=tETHUSD"})]}),"\n",(0,r.jsx)(t.p,{children:"We'll get an minimal array as the returned data. Refer to the doc we know each column means:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"[\n// on trading pairs (ex. tBTCUSD)\n  [\n    SYMBOL,\n    BID, \n    BID_SIZE, \n    ASK, \n    ASK_SIZE, \n    DAILY_CHANGE, \n    DAILY_CHANGE_PERC, \n    LAST_PRICE, \n    VOLUME, \n    HIGH, \n    LOW\n  ],\n]\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Then we can process the array to get what we want. For example, to access the last price of ETH/USD, we could find the result from ",(0,r.jsx)(t.code,{children:"array[0][7]"})," (The first item in returned array denotes ETH/USD result array, the 8th item(the array count from 0 so its 7) in ETH/USD result array is the LAST_PRICE)"]}),"\n",(0,r.jsx)(t.h3,{id:"interact-with-api-library",children:"Interact with API library"}),"\n",(0,r.jsx)(t.p,{children:"But for more complicated interaction like place an order with authenticated API, we generally prefer to call language specific library to simplify the process."}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.a,{href:"https://docs.bitfinex.com/v2/docs/open-source-libraries",children:"Bitfinex official doc"})," listed several open source language specific libraries for developers."]}),"\n",(0,r.jsxs)(t.p,{children:["For example, we can use nodejs/javascript to access Bitfinex API via ",(0,r.jsx)(t.a,{href:"https://github.com/bitfinexcom/bitfinex-api-node",children:"Bitfinex's nodejs API library"})]}),"\n",(0,r.jsx)(t.p,{children:"To install the library, call"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sh",children:"$ npm install bitfinex-api-node\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Then you can edit a ",(0,r.jsx)(t.code,{children:"demo.js"})," file with content:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:"const BFX = require('bitfinex-api-node')\nconst bfx = new BFX()\nconst rest = bfx.rest(2)\nrest.tickers(['tETHUSD']).then(tickers => {\n  console.log(tickers)\n})\n"})}),"\n",(0,r.jsx)(t.p,{children:"to get same result as directly call the REST API on the browser."}),"\n",(0,r.jsx)(t.p,{children:"Though You may not know the node API build-in the data model mapping, which saves you from manually parsing the returned result."}),"\n",(0,r.jsxs)(t.p,{children:["All you need to do is pass ",(0,r.jsx)(t.code,{children:"{ transform: true}"})," parameter when access the ",(0,r.jsx)(t.code,{children:"bfx.rest"})," method:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:"const rest = bfx.rest(2, { transform: true })\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Then you can get value via ",(0,r.jsx)(t.code,{children:"ticker.lastPrice"}),", ",(0,r.jsx)(t.code,{children:"ticker.high"}),"..."]}),"\n",(0,r.jsxs)(t.p,{children:["If you want to access authenticated APIs, just pass the ",(0,r.jsx)(t.code,{children:"apiKey"})," and ",(0,r.jsx)(t.code,{children:"apiSecret"})," when construct the ",(0,r.jsx)(t.code,{children:"bfx"})," api instance."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:"const bfx = new BFX({\n  apiKey: '...',\n  apiSecret: '...',\n})\n"})}),"\n",(0,r.jsx)(t.p,{children:"The API call seems not hard but it did require some effort to make all works."}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Disclosure:"})," I am currently working on Bitfinex. ",(0,r.jsx)(t.a,{href:"https://github.com/gasolin/node-red-contrib-bitfinex",children:"Node-red-contrib-bitfinex"})," is the personal project though."]})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);